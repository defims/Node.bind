!function(a,b,c){function d(){}function e(a){var b=this;b.origin=a}function f(a){var b=this,c=a.split("|");b.origin=a,b.path=c[0],b.filter=new d(c[1]),b.parsed=b.parse(a||"")}function g(a){var b=this;b.origin=a,b.parsed=b.parse(a||"")}function h(a){var b=this;b.origin=a,b.parsed=b.parse(a)}function i(a,b,c,d){var e=this;e.node=a,e.scope=c,e.directive=new h(b),e.template=new g(d),e.bindings=[],e.refreshListener()}function j(a,b){for(var c,d=z.length,e=this;d--;)if(c=z[d],c.object==a&&c.property==b)return c;e.object=a,e.property=b,e.bindings=[],e.refreshListener(),z.push(e)}function k(a,b){var c,d;if("object"==typeof a&&"object"==typeof b){for(c in a){if("undefined"==typeof b[c])return!1;if(b[c]&&!a[c])return!1;if(d=typeof a[c],"object"===d&&!k(a[c],b[c]))return!1;if("function"===d&&("undefined"==typeof b[c]||a[c].toString()!==b[c].toString()))return!1;if(a[c]!==b[c])return!1}for(c in b)if("undefined"==typeof a[c])return!1;return!0}return a===b}function l(a,b,c){var d,e,f={};for(d in b)e=b[d],d in a&&(a[d]===e||d in f&&f[d]===e)||(a[d]=c?c(e):e);return a}function m(a){if(!a||"object"!=typeof a||"[object Function]"===Object.prototype.toString.call(a))return a;if(a instanceof Date)return new Date(a.getTime());if(a instanceof RegExp)return new RegExp(a);var b,c,d;if(a instanceof Array)for(b=[],c=0,d=a.length;d>c;++c)c in a&&b.push(m(a[c]));else b=a.constructor?new a.constructor:{};return l(b,a,m)}function n(a,b,c){B.push({object:a,property:b,callback:c,clone:m(a[b])})}function o(){for(var a,b,c=B.length;c--;)a=B[c],b=a.object[a.property],k(a.clone,b)||(a.clone=m(b),a.callback())}function p(a,b){return function(){var c=this,d=arguments;try{a.apply(c,d)}finally{b.apply(c,d)}}}function q(a,b){var c=a[b];a[b]=function(){for(var a,b,d,e=arguments,f=e.length;f--;)a=e[f],"function"==typeof a&&(b=e[f],d=p(a,o),e[f]=d,d.nbOriginCallback=d.nbOriginCallback||[],d.nbOriginCallback.push(b),b.nbAfterCallback=b.nbAfterCallback||[],b.nbAfterCallback.push(d));c.apply(this,e)}}function r(a,b,c,d){var e,f,g,h;for(e=a.nodeName?[a]:a,d||("string"==typeof c?f=c:g=c),h=e.length;h--;)r.core(e[h],b,g,f)}var s={};s.path2Array=function(a){return a.replace(/^\[/g,"").replace(/\[/g,".").replace(/\]/g,"").split(".")};var t=d.prototype;t.render=function(){},t.compile=function(){};var u=e.prototype;u.getValue=function(a){var b,c=this,d=c.origin;if("$index"==d){for(var e=!1,f=a;f;){if(f.nbPrototype||f.nbInstances){e=!0;break}f=f.parentElement}if(b=0,e&&f.nbPrototype){for(;f&&(f.nbPrototype&&b--,!f.nbInstances);)f=f.previousSibling;b=-b}}else b=d;return b};var v=f.prototype;v.getValue=function(a,b){var c=this,d=c.getObjectProperty(a,b),e=d.object,f=d.property;return""!==f?e[f]||"":void 0},v.setValue=function(){},v.parse=function(a){for(var b,c=s.path2Array(a),d=c.length;d--;)b=c[d],"$"==b.charAt(0)&&(c[d]=new e(b));return c},v.getObjectProperty=function(a,b){var d,e,f=this,g=f.parsed,h=g.length-1,i=g[0],j=b[0],k=b.length,l=!1,m={};for(i.getValue&&(i=i.getValue(a)),e=0;k>e;e++)if(j=b[e],j.hasOwnProperty(i)){l=!0;break}if(l)for(m=j,d=g[h],e=0;h>e;e++){if(i=g[e],i.getValue&&(i=i.getValue(a)),!m.hasOwnProperty(i)||m[i]===c){m={},d=c;break}m=m[i]}return{object:m,property:d}};var w=g.prototype;w.set=function(){},w.getValue=function(a,b){for(var c,d=this,e=d.parsed,f=e.length,g=[];f--;)c=e[f],c.getValue&&(c=c.getValue(a,b)),g.unshift(c);return 0!==g.length?g:[]},w.setValue=function(){},w.parse=function(a){for(var b,c=a.length,d=[],e="",g=!1;c--;)b=a[c],g&&"{"==b&&"{"==a[c-1]?(c--,e&&d.unshift(new f(e)),e="",g=!1):g||"}"!=b||"}"!=a[c-1]?e=b+e:(c--,e&&d.unshift(e),e="",g=!0);return e&&d.unshift(e),d},w.getObjectProperty=function(a,b,c){for(var d,e=a.template.parsed,f=e.length,g=[];f--;)d=e[f],d&&d.path&&g.push(d.getObjectProperty(b,c));return g.length?g:[{object:c[0],property:""}]},w.unbind=function(){};var x=h.prototype;x.parse=function(a){var b=s.path2Array(a);return{type:b.shift(),detail:b}};var y=i.prototype;y.set=function(){},y.getScopes=function(){var a,c=this,d=c.directive.parsed.type,e=c.node,f=b,g=[];for(c.scope&&g.push(c.scope),("repeat"==d||"scope"==d)&&(e=e.parentElement);e;)a=e.nbScope,a&&g.push(a),e=e.parentElement;return f.nbScope=f.nbScope||f,g.push(f.nbScope),g},y.render=function(){var a=this,b=a.node,d=b.nodeType,e=a.directive.parsed,f=e.type.toLowerCase(),g=e.detail,h=a.template,i=a.getScopes(),j=h.getValue(b,i),k=1,l=3;if("scope"==f)d==k&&(j=j[0]||i[0],b.nbScope!=j&&r.setTreeScope(b,j));else if("repeat"==f){if(d==k)if(j=j[0]||i[0],b.nbPrototype)b.nbScope!=j&&r.setTreeScope(b,j);else{var m,n,o,p,q,s,t,u,v,w=j.length,x=b.nbInstances=b.nbInstances||[];for(m=0;w>m;m++)0==m?(q=b,q.nbScope!=j&&r.setTreeScope(q,j)):x[m-1]?(q=x[m-1],q.nbScope!=j&&r.setTreeScope(q,j)):(p=b.cloneNode(!0),q.parentNode.insertBefore(p,q.nextSibling),p.nbPrototype=b,p.nbScope=b.nbScope,x.push(p),r.walkTree(b,function(a,b){if(currNode=this,s=currNode.nbViews){for(currNewNode=p,n=0,v=b.length;v>n;n++)currNewNode=currNewNode.childNodes[b[n]];for(u=s.length;u--;)t=s[u],t!=self&&r.core(currNewNode,t.directive.origin,t.scope,t.template.origin)}}),q=p);if(w-=2,w>0)for(;++w<x.length;)q=x[w],q.parentNode.removeChild(q),x[w]=c}}else if("textcontent"==f)j=j.join(""),d==k?b.textContent!=j&&(b.textContent=j):d==l&&b.nodeValue!=j&&(b.nodeValue=j);else if("attribute"==f){if(d==k){var y=g[0];if("id"==y&&b.id!=j)b.id=j;else if("class"==y){for(var z,A,B,C,D,w=j.length,E=[];w--;)if(z=j[w],A=Object.prototype.toString.call(z),"[object Array]"===A)E.unshift(z.join(" "));else if("[object Object]"===A){var F,G="";for(F in z)G+=" "+z[F];E.unshift(G)}else E.unshift(z);if(E=E.join("").replace(/ +/g," ").replace(/^\s+|\s+$/g,""),B=b.className,D=b.nbLastClass)for(C=D.length;C--;)B=B.replace(D[C],"");(D===c||D.join(" ")!=E)&&(b.className=(B+" "+E).replace(/ +/g," ").replace(/^\s+|\s+$/g,""),b.nbLastClass=E.split(" "))}else if("style"==y){if(g[1]){var o,m,H,I,J=j.length,K=g.length-1,H=b.style,I=g[K];for(m=1;K>m;m++)H=H[g[m]];for(;J--;)H[I]=j[J]}else for(var o,w=j.length;w--;)if(o=j[w],"string"==typeof o)for(var L,M=o.split(";"),N=M.length;N--;)L=M[N].split(":"),b.style[L[0].replace(" ","")]=L[1];else if("[object Object]"==Object.prototype.toString.call(o)){var F;for(F in o)b.style[F]=o[F]}}else if("value"==y)b.value=j;else{var K=g.length-1,J=j.length;if(K>0){var m,o,y=b.attributes,I=g[K];for(m=0;K>m;m++)o=g[m],y[o]||(y[o]={}),y=y[o];for(;J--;)y[I]=j[J]}else for(;J--;){var j=j[J];j&&b.setAttribute(g[0],j)}}}}else if("dataset"==f){var m,K=g.length,J=j.length,O=g[0];for(m=1;K>m;m++)O+="-"+g[m];for(;J--;)b.setAttribute("data-"+O,j[J])}else if("event"==f){for(var o,J=j.length,P=b.nbEvents=b.nbEvents||[],Q=g[0];P.length;)b.removeEventListener(Q,P.pop());for(;J--;)o=j[J],"function"==typeof o&&(P.push(o),b.addEventListener(Q,o))}else if("nodevalue"==f)j=j.join(""),d==k?b.textContent!=j&&(b.nodeValue=j):d==l&&b.nodeValue!=j&&(b.nodeValue=j);else{var m,o,K=g.length,J=j.length,O=f;for(m=0;K>m;m++)o=g[m],O+=o.substring(0,1).toUpperCase()+o.substring(1);for(;J--;)b[O]=j[J]}},y.getBinding=function(a){for(var b,d=this,e=d.bindings,f=e.length,g=!1;f--;)if(b=e[f],b.target==a){g=!0;break}return g||(b={target:a,callback:c},e.push(b)),b},y.bind=function(a,b){this.getBinding(a).callback=b},y.unbind=function(){},y.getObjectProperty=function(){var a=this,b=a.node,c=a.getScopes();return a.template.getObjectProperty(a,b,c)},y.change=function(){},y.refreshListener=function(){};var z=[],A=j.prototype;A.get=function(){},A.set=function(){},A.update=function(){},A.change=function(){for(var a,b=this,c=b.bindings,d=c.length;d--;)a=c[d],a.callback.call(a.target)};var B=[];q(b,"setTimeout"),q(b,"setInterval");var C,D=Node.prototype;b.EventTarget!=c&&(D=b.EventTarget),q(D,"addEventListener"),C=D.removeEventListener,D.removeEventListener=p(C,function(a,b){for(var c=b.nbAfterCallback,d=c.length;d--;)C.call(this,a,c[d]);o()}),A.refreshListener=function(){function a(a,c){"[object Array]"===Object.prototype.toString.call(a[c])&&n(a[c],"length",function(){b.change.call(b)})}var b=this,d=b.object,e=b.property;if(""!==e&&"object"==typeof d&&null!=e&&e!=c){try{var f=d[e];Object.defineProperty(d,e,{get:function(){return f},set:function(c){f=c,a(d,e),b.change()},configurable:!0})}catch(g){n(d,e,function(){a(d,e),b.change.call(b)})}a(d,e)}},A.getBinding=function(a){for(var b,d=this,e=d.bindings,f=e.length,g=!1;f--;)if(b=e[f],b.target==a){g=!0;break}return g||(b={target:a,callback:c},e.push(b)),b},A.bind=function(a,b){var c=this,d=c.getBinding(a);d.callback=b},A.unbind=function(){},r.core=function(a,b,c,d){var e,f,g,h,k,l,m;for(f=new i(a,b,c,d),e=a.nbViews=a.nbViews||[],e.push(f),g=a.nbModels=a.nbModels||[],k=f.getObjectProperty(),m=k.length;m--;)l=k[m],h=new j(l.object,l.property),g.push(h),f.bind(h,h.update),h.bind(f,f.render);f.render()},r.walkTree=function(a,b){var c,d,e=[],f=0;do c||(c=b.call(a,f,e)===!1),!c&&(d=a.firstChild)?(f++,e.push(0)):(d=a.nextSibling)?(c=!1,e[e.length-1]++):(d=a.parentNode,f--,c=!0,e.pop()),a=d;while(f>0)},r.setTreeScope=function(a,b){if(b){a.nbScope=b;var c,d,e,f,g,h,i,k,l;r.walkTree(a,function(){if(c=this,d=c.nbViews)for(e=d.length,f=c.nbModels=[];e--;){for(g=d[e],h=g.getObjectProperty(),i=h.length;i--;)k=h[i],l=new j(k.object,k.property),f.push(l),g.bind(l,l.update),l.bind(g,g.render);g.render()}})}},b.NodeBind=r}(document,window);
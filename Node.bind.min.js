!function(a,b,c){function d(){}function e(a){var b=this;b.origin=a}function f(a){var b=this,c=a.split("|");b.origin=a,b.path=c[0],b.filter=new d(c[1]),b.parsed=b.parse(a||"")}function g(a){var b=this;b.origin=a,b.parsed=b.parse(a||"")}function h(a){var b=this;b.origin=a,b.parsed=b.parse(a)}function i(a,b,c,d){var e=this;e.node=a,e.scope=c,e.directive=new h(b),e.template=new g(d),e.bindings=[],e.refreshListener()}function j(a,b){for(var c,d=y.length,e=this;d--;)if(c=y[d],c.object==a&&c.property==b)return c;e.object=a,e.property=b,e.bindings=[],e.refreshListener(),y.push(e)}function k(a,b){var c,d;if("object"==typeof a&&"object"==typeof b){for(c in a){if("undefined"==typeof b[c])return!1;if(b[c]&&!a[c])return!1;if(d=typeof a[c],"object"===d&&!k(a[c],b[c]))return!1;if("function"===d&&("undefined"==typeof b[c]||a[c].toString()!==b[c].toString()))return!1;if(a[c]!==b[c])return!1}for(c in b)if("undefined"==typeof a[c])return!1;return!0}return a===b}function l(a){function b(a,b,c){var d,e,f={};for(d in b)e=b[d],d in a&&(a[d]===e||d in f&&f[d]===e)||(a[d]=c?c(e):e);return a}if(!a||"object"!=typeof a||"[object Function]"===Object.prototype.toString.call(a))return a;if(a instanceof Date)return new Date(a.getTime());if(a instanceof RegExp)return new RegExp(a);var c,d,e;if(a instanceof Array)for(c=[],d=0,e=a.length;e>d;++d)d in a&&c.push(l(a[d]));else c=a.constructor?new a.constructor:{};return b(c,a,l)}function m(a,b,c){A.push({object:a,property:b,callback:c,clone:l(a[b])})}function n(){for(var a,b,c=A.length;c--;)a=A[c],b=a.object[a.property],k(a.clone,b)||(a.clone=l(b),a.callback())}function o(a,b){return function(){var c=this,d=arguments;try{a.apply(c,d)}finally{b.apply(c,d)}}}function p(a,b){var c=a[b];a[b]=function(){for(var a,b,d,e=arguments,f=e.length;f--;)a=e[f],"function"==typeof a&&(b=e[f],d=o(a,n),e[f]=d,d.nbOriginCallback=d.nbOriginCallback||[],d.nbOriginCallback.push(b),b.nbAfterCallback=b.nbAfterCallback||[],b.nbAfterCallback.push(d));c.apply(this,e)}}function q(a,b,d,e){var f,g,h,i;for(f=a.nodeName?[a]:a,e||"string"==typeof d&&(g=d,h=c),i=f.length;i--;)q.core(f[i],b,h,g)}var r={};r.path2Array=function(a){return a.replace(/^\[/g,"").replace(/\[/g,".").replace(/\]/g,"").split(".")};var s=d.prototype;s.render=function(){},s.compile=function(){};var t=e.prototype;t.getValue=function(a){var b,c=this,d=c.origin;if("$index"==d){for(var e=!1,f=a;f;){if(f.nbPrototype||f.nbInstances){e=!0;break}f=f.parentElement}if(b=0,e&&f.nbPrototype){for(;f&&(f.nbPrototype&&b--,!f.nbInstances);)f=f.previousSibling;b=-b}}else b=d;return b};var u=f.prototype;u.getValue=function(a,b){var c=this,d=c.getObjectProperty(a,b),e=d.object,f=d.property;return""!==f?e[f]||"":void 0},u.setValue=function(){},u.parse=function(a){for(var b,c=r.path2Array(a),d=c.length;d--;)b=c[d],"$"==b.charAt(0)&&(c[d]=new e(b));return c},u.getObjectProperty=function(a,b){var d,e=this,f=e.parsed,g=f.length-1,h=b,i=f[g],j=i;for(i.getValue&&(j=i.getValue(a)),d=0;g>d;d++)if(i=f[d],i.getValue&&(i=i.getValue(a)),h=h[i],!h)return{object:{},property:c};return{object:h,property:j}};var v=g.prototype;v.set=function(){},v.getValue=function(a,b){for(var c,d=this,e=d.parsed,f=e.length,g=[];f--;)c=e[f],c.getValue&&(c=c.getValue(a,b)),g.unshift(c);return 0!==g.length?g:[]},v.setValue=function(){},v.parse=function(a){for(var b,c=a.length,d=[],e="",g=!1;c--;)b=a[c],g&&"{"==b&&"{"==a[c-1]?(c--,e&&d.unshift(new f(e)),e="",g=!1):g||"}"!=b||"}"!=a[c-1]?e=b+e:(c--,e&&d.unshift(e),e="",g=!0);return e&&d.unshift(e),d},v.getObjectProperty=function(a,b,c){for(var d,e=a.template.parsed,f=e.length,g=[];f--;)d=e[f],d&&d.path&&g.push(d.getObjectProperty(b,c));return g.length?g:[{object:c,property:""}]},v.unbind=function(){};var w=h.prototype;w.parse=function(a){var b=r.path2Array(a);return{type:b.shift(),detail:b}};var x=i.prototype;x.set=function(){},x.getScope=function(){var a=this,c=a.directive.parsed.type,d=a.node,e=!1,f=b,g=a.scope;if(g)return g;for(("repeat"==c||"scope"==c)&&(d=d.parentElement);d;){if(g=d.nbScope){e=!0;break}d=d.parentElement}return e||(f.nbScope=f,g=f.nbScope),g},x.render=function(){var a=this,b=a.node,d=b.nodeType,e=a.directive.parsed,f=e.type.toLowerCase(),g=e.detail,h=a.template,i=a.getScope(),j=h.getValue(b,i),k=1,l=3;if("scope"==f)d==k&&(j=j[0]||i,b.nbScope!=j&&q.setTreeScope(b,j));else if("repeat"==f){if(d==k)if(j=j[0]||i,b.nbPrototype)b.nbScope!=j&&q.setTreeScope(b,j);else{var m,n,o,p,r,s,t,u,v,w=j.length,x=b.nbInstances=b.nbInstances||[];for(m=0;w>m;m++)0==m?(r=b,r.nbScope!=j&&q.setTreeScope(r,j)):x[m-1]?(r=x[m-1],r.nbScope!=j&&q.setTreeScope(r,j)):(p=b.cloneNode(!0),r.parentNode.insertBefore(p,r.nextSibling),p.nbPrototype=b,p.nbScope=b.nbScope,x.push(p),q.walkTree(b,function(b,c){if(currNode=this,s=currNode.nbViews){for(currNewNode=p,n=0,v=c.length;v>n;n++)currNewNode=currNewNode.childNodes[c[n]];for(u=s.length;u--;)t=s[u],t!=a&&q.core(currNewNode,t.directive.origin,t.scope,t.template.origin)}}),r=p);for(w-=2;++w<x.length;)r=x[w],r.parentNode.removeChild(r),x[w]=c}}else if("textcontent"==f)j=j.join(""),d==k?b.textContent!=j&&(b.textContent=j):d==l&&b.nodeValue!=j&&(b.nodeValue=j);else if("attribute"==f){if(d==k){var y=g[0];if("id"==y&&b.id!=j)b.id=j;else if("class"==y){for(var z,A,w=j.length,B=[];w--;)if(z=j[w],A=Object.prototype.toString.call(z),"[object Array]"===A)B.push(z.join(" "));else if("[object Object]"===A){var C,D="";for(C in z)D+=" "+z[C];B.push(D)}else B.push(z);b.className!=B&&(b.className=B)}else if("style"==y){if(g[1]){var o,m,E,F,G=j.length,H=g.length-1,E=b.style,F=g[H];for(m=1;H>m;m++)E=E[g[m]];for(;G--;)E[F]=j[G]}else for(var o,w=j.length;w--;)if(o=j[w],"string"==typeof o)for(var I,J=o.split(";"),K=J.length;K--;)I=J[K].split(":"),b.style[I[0].replace(" ","")]=I[1];else if("[object Object]"==Object.prototype.toString.call(o)){var C;for(C in o)b.style[C]=o[C]}}else if("value"==y)b.value=j;else{var m,o,H=g.length-1,G=j.length,y=b.attributes,F=g[H];for(m=0;H>m;m++)o=g[m],y[o]||(y[o]={}),y=y[o];for(;G--;)y[F]=j[G]}}}else if("dataset"==f){var m,H=g.length,G=j.length,L=g[0];for(m=1;H>m;m++)L+="-"+g[m];for(;G--;)b.setAttribute("data-"+L,j[G])}else if("event"==f){for(var o,G=j.length,M=b.nbEvents=b.nbEvents||[],N=g[0];M.length;)b.removeEventListener(N,M.pop());for(;G--;)o=j[G],"function"==typeof o&&(M.push(o),b.addEventListener(N,o))}else"nodevalue"==f&&(j=j.join(""),d==k?b.textContent!=j&&(b.nodeValue=j):d==l&&b.nodeValue!=j&&(b.nodeValue=j))},x.getBinding=function(a){for(var b,d=this,e=d.bindings,f=e.length,g=!1;f--;)if(b=e[f],b.target==a){g=!0;break}return g||(b={target:a,callback:c},e.push(b)),b},x.bind=function(a,b){var c=this,d=c.getBinding(a);d.callback=b},x.unbind=function(){},x.getObjectProperty=function(){var a=this,b=a.node,c=a.getScope();return a.template.getObjectProperty(a,b,c)},x.change=function(){},x.refreshListener=function(){};var y=[],z=j.prototype;z.get=function(){},z.set=function(){},z.update=function(){},z.change=function(){for(var a,b=this,c=b.bindings,d=c.length;d--;)a=c[d],a.callback.call(a.target)};var A=[];_o=[],_a=[],p(b,"setTimeout"),p(b,"setInterval"),p(EventTarget.prototype,"addEventListener");var B=EventTarget.prototype;_removeEventListener=B.removeEventListener,B.removeEventListener=o(_removeEventListener,function(a,b){for(var c=b.nbAfterCallback,d=c.length;d--;)_removeEventListener.call(this,a,c[d]);n()}),z.refreshListener=function(){function a(a,c){"[object Array]"===Object.prototype.toString.call(a[c])&&m(a[c],"length",function(){b.change.call(b)})}var b=this,d=b.object,e=b.property;if(""!==e&&"object"==typeof d&&null!=e&&e!=c){try{var f=d[e];Object.defineProperty(d,e,{get:function(){return f},set:function(c){f=c,a(d,e),b.change()},configurable:!0})}catch(g){m(d,e,function(){a(d,e),b.change.call(b)})}a(d,e)}},z.getBinding=function(a){for(var b,d=this,e=d.bindings,f=e.length,g=!1;f--;)if(b=e[f],b.target==a){g=!0;break}return g||(b={target:a,callback:c},e.push(b)),b},z.bind=function(a,b){var c=this,d=c.getBinding(a);d.callback=b},z.unbind=function(){},q.core=function(a,b,c,d){var e,f,g,h,k,l,m;for(f=new i(a,b,c,d),e=a.nbViews=a.nbViews||[],e.push(f),g=a.nbModels=a.nbModels||[],k=f.getObjectProperty(),m=k.length;m--;)l=k[m],h=new j(l.object,l.property),g.push(h),f.bind(h,h.update),h.bind(f,f.render);f.render()},q.walkTree=function(a,b){var c,d,e=[],f=0;do c||(c=b.call(a,f,e)===!1),!c&&(d=a.firstChild)?(f++,e.push(0)):(d=a.nextSibling)?(c=!1,e[e.length-1]++):(d=a.parentNode,f--,c=!0,e.pop()),a=d;while(f>0)},q.setTreeScope=function(a,b){if(b){a.nbScope=b;var c,d,e,f,g,h,i,k,l;q.walkTree(a,function(){if(c=this,d=c.nbViews)for(e=d.length,f=c.nbModels=[];e--;){for(g=d[e],h=g.getObjectProperty(),i=h.length;i--;)k=h[i],l=new j(k.object,k.property),f.push(l),g.bind(l,l.update),l.bind(g,g.render);g.render()}})}},b.NodeBind=q}(document,window);